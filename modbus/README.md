# jg

适配JG-Gateway设备的Modbus包

## Contributors

| 参与者   | 时间                | email            |
|-------|-------------------|------------------|
| zyc   | 2022-08 ~ 2023-01 | 584405019@qq.com |
| voson | 2023-02 ~ 2023-03 | 664241487@qq.com |


## 格式

### 基本格式

使用可变帧长。数据传输顺序为低位在前，高位在后；低字节在前，高字节在后。

1字节	1字节	1字节	1字节	1字节	6字节	1字节	N字节	1字节	1字节
68H		长度L	长度L	68H		控制		终端地址	命令码	用户数据	校验CS	16H

### 长度L

从控制域到用户数据的字节总长度，第2个报文长度L与第一个报文长度L相同。

### 控制字

1个字节，定义数据传送方向及数据帧种类。

### 终端地址

6个字节，选址范围为000000000001H～FFFFFFFFFFFFH，其中FFFFFFFFFFFFH为广播地址，000000000000H为无效地址。



### CRC 校验

1个字节，是控制字、终端地址、命令码、用户数据的字节的八位位组算术和，不考虑溢出位，即：CS＝（控制字+终端地址+命令码+用户数据）MOD 256。

### 注册包、心跳包
68 10 10 68 80 00 00 00 00 00 00（固定格式） 8b（注册帧控制字）（收到的这里是8d的是心跳包） 18 21 06 23 00 96 （集中器ID）71 00（数据序号，上电初始值为0） 74（cs校验和） 16



